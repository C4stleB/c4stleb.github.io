---
layout: post
title: "サーバオーケストラレーションについて"
date: 2020-05-10 17:00:00 +0300
description: 
img: docker-swarm-gonkar-it-security.png
---

## サーバオーケストラレーション Server Orchestration
サーバオーケストラレーションという用語は曖昧な意味を持っています。簡単に定義すると、**複数のサーバと複数のサービスを便利に管理する作業**であると言えます。実際にはスケジューリング`scheduling`、クラスタリング`clustering`、サービスディスカバリー`service discovery`、ロギング`logging`、モニタリング`monitoring`などの作業を行います。

ただ、複数のサーバーを楽に管理したいだけなのに、新しい用語がたくさん登場します。

**スケジューリング**：コンテナを適当なサーバにデプロイする作業です。ツールによって支援する戦略が少しずつ異なりますが、数台のサーバの中で最も必要のないサーバにデプロイしたり、順番にデプロイしたり、ランダムにデプロイすることもできます。コンテナの個数を複数に増やせば、適当に分けてデプロイし、サーバーが死ぬと、実行中だったコンテナを別のサーバーで実行することもできます。

**クラスタリング**：複数のサーバを1つのサーバのように使用できます。クラスタに新しいサーバーを追加することも、削除することもできます。少なくとも数少ないサーバから、多くは数千台のサーバを1つのクラスタにすることができます。あちこちに散らばっているコンテナも仮想ネットワークを利用して、まるで同じサーバーにあるように簡単に通信できます。

**サービスディスカバリ**：文字通り、サービスを探す機能です。コンテナはクラスタ環境でどのサーバに生成されるか分からず、別のサーバに移動することもできます。したがって、コンテナと通信をするためには、どのサーバで実行中なのかを把握しなければならず、コンテナが生成・中止する時にどこかにIPやポートのような情報をアップデートする必要があります。キーベバリュー・ストレージに情報を保存することも、内部DNSサーバーを利用することもできます。

**ロギング、モニタリング**：複数のサーバーを管理する場合は、ログとサーバーの状態を1ヶ所で管理するのが便利です。ツールで直接サポートする場合もあれば、別途プログラムをインストールしなければならない場合もあります。ELKやprometheusなどさまざまなツールがあります。

オーケストレーション・ツールはサーバを中央で管理し、多くのことを自動化してくれるので、複数のサーバを管理するのなら、導入しなければならない非常に優れた方法だと言えます。

しかし、**こんなに良いものがあると知りながらも、様々な理由で導入が難しいのが現実**です。 

最も大きな理由は、インストールと管理が難しいということです。普段ならオーケストラツールは数百、数千、数万台の膨大なサーバーを管理するためにできています。基本、インストールと管理がかなり難しく、大規模のシステム環境を持つ一部の企業を除いては、導入する費用が手作業で管理する費用よりはるかに大きいです。ツールについても勉強しなければなりません。何か障害が生じると、全サーバーに問題が生じるので、導入が慎重にならざるを得ません。

